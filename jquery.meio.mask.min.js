(function(C){var A=((C.browser.opera||(C.browser.mozilla&&parseFloat(C.browser.version.substr(0,3))<1.9))?"input":"paste");var B=function(E){E=C.event.fix(E||window.event);E.type="paste";var D=E.target;setTimeout(function(){C.event.dispatch.call(D,E)},1)};C.event.special.paste={setup:function(){if(this.addEventListener){this.addEventListener(A,B,false)}else{if(this.attachEvent){this.attachEvent("on"+A,B)}}},teardown:function(){if(this.removeEventListener){this.removeEventListener(A,B,false)}else{if(this.detachEvent){this.detachEvent("on"+A,B)}}}};C.extend({mask:{rules:{"z":/[a-z]/,"Z":/[A-Z]/,"a":/[a-zA-Z]/,"*":/[0-9a-zA-Z]/,"@":/[0-9a-zA-ZçÇáàãâéèêíìóòôõúùü]/},keyRepresentation:{8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",27:"esc",33:"page up",34:"page down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",116:"f5",123:"f12",224:"command"},signals:{"+":"","-":"-"},options:{attr:"alt",mask:null,type:"fixed",maxLength:-1,defaultValue:"",signal:false,textAlign:true,selectCharsOnFocus:true,autoTab:true,setSize:false,fixedChars:"[(),.:/ -]",onInvalid:function(){},onValid:function(){},onOverflow:function(){}},masks:{"phone":{mask:"(99) 9999-9999"},"phone-us":{mask:"(999) 999-9999"},"cpf":{mask:"999.999.999-99"},"cnpj":{mask:"99.999.999/9999-99"},"date":{mask:"39/19/9999"},"date-us":{mask:"19/39/9999"},"cep":{mask:"99999-999"},"time":{mask:"29:59"},"cc":{mask:"9999 9999 9999 9999"},"integer":{mask:"999.999.999.999",type:"reverse"},"decimal":{mask:"99,999.999.999.999",type:"reverse",defaultValue:"000"},"decimal-us":{mask:"99.999,999,999,999",type:"reverse",defaultValue:"000"},"signed-decimal":{mask:"99,999.999.999.999",type:"reverse",defaultValue:"+000"},"signed-decimal-us":{mask:"99,999.999.999.999",type:"reverse",defaultValue:"+000"}},init:function(){if(!this.hasInit){var D=this,E,F=this.keyRepresentation;this.ignore=false;for(E=0;E<=9;E++){this.rules[E]=new RegExp("[0-"+E+"]")}this.keyRep=F;this.ignoreKeys=[];C.each(F,function(G){D.ignoreKeys.push(parseInt(G,10))});this.hasInit=true}},set:function(H,E){var D=this,F=C(H),G="maxLength";E=E||{};this.init();return F.each(function(){if(E.attr){D.options.attr=E.attr}var N=C(this),P=C.extend({},D.options),M=N.attr(P.attr),I="";I=(typeof E=="string")?E:(M!=="")?M:null;if(I){P.mask=I}if(D.masks[I]){P=C.extend(P,D.masks[I])}if(typeof E=="object"&&E.constructor!=Array){P=C.extend(P,E)}if(C.metadata){P=C.extend(P,N.metadata())}if(P.mask!=null){P.mask+="";if(N.data("mask")){D.unset(N)}var J=P.defaultValue,K=(P.type==="reverse"),L=new RegExp(P.fixedChars,"g");if(P.maxLength===-1){P.maxLength=N.attr(G)}P=C.extend({},P,{fixedCharsReg:new RegExp(P.fixedChars),fixedCharsRegG:L,maskArray:P.mask.split(""),maskNonFixedCharsArray:P.mask.replace(L,"").split("")});if((P.type=="fixed"||K)&&P.setSize&&!N.attr("size")){N.attr("size",P.mask.length)}if(K&&P.textAlign){N.css("text-align","right")}if(this.value!==""||J!==""){var O=D.string((this.value!=="")?this.value:J,P);this.defaultValue=O;N.val(O)}if(P.type=="infinite"){P.type="repeat"}N.data("mask",P);N.removeAttr(G);N.bind("keydown.mask",{func:D._onKeyDown,thisObj:D},D._onMask).bind("keypress.mask",{func:D._onKeyPress,thisObj:D},D._onMask).bind("keyup.mask",{func:D._onKeyUp,thisObj:D},D._onMask).bind("paste.mask",{func:D._onPaste,thisObj:D},D._onMask).bind("focus.mask",D._onFocus).bind("blur.mask",D._onBlur).bind("change.mask",D._onChange)}})},unset:function(E){var D=C(E);return D.each(function(){var G=C(this);if(G.data("mask")){var F=G.data("mask").maxLength;if(F!=-1){G.attr("maxLength",F)}G.unbind(".mask").removeData("mask")}})},string:function(I,E){this.init();var H={};if(typeof I!="string"){I=String(I)}switch(typeof E){case"string":if(this.masks[E]){H=C.extend(H,this.masks[E])}else{H.mask=E}break;case"object":H=E}if(!H.fixedChars){H.fixedChars=this.options.fixedChars}var D=new RegExp(H.fixedChars),F=new RegExp(H.fixedChars,"g");if((H.type==="reverse")&&H.defaultValue){if(typeof this.signals[H.defaultValue.charAt(0)]!="undefined"){var G=I.charAt(0);H.signal=(typeof this.signals[G]!="undefined")?this.signals[G]:this.signals[H.defaultValue.charAt(0)];H.defaultValue=H.defaultValue.substring(1)}}return this.__maskArray(I.split(""),H.mask.replace(F,"").split(""),H.mask.split(""),H.type,H.maxLength,H.defaultValue,D,H.signal)},_onFocus:function(F){var E=C(this),D=E.data("mask");D.inputFocusValue=E.val();D.changed=false;if(D.selectCharsOnFocus){setTimeout(function(){E.select()},50)}},_onBlur:function(F){var E=C(this),D=E.data("mask");if(D.inputFocusValue!=E.val()&&!D.changed){E.trigger("change")}},_onChange:function(D){C(this).data("mask").changed=true},_onMask:function(D){var F=D.data.thisObj,E={};E._this=D.target;E.$this=C(E._this);E.data=E.$this.data("mask");if(E.$this.attr("readonly")||!E.data){return true}E[E.data.type]=true;E.value=E.$this.val();E.nKey=F.__getKeyNumber(D);E.range=F.__getRange(E._this);E.valueArray=E.value.split("");return D.data.func.call(F,D,E)},_onKeyDown:function(E,F){this.ignore=C.inArray(F.nKey,this.ignoreKeys)>-1||E.ctrlKey||E.metaKey||E.altKey;if(this.ignore){var D=this.keyRep[F.nKey];F.data.onValid.call(F._this,D||"",F.nKey)}return true},_onKeyUp:function(D,E){if(E.nKey===9||E.nKey===16){return true}if(E.repeat){this.__autoTab(E);return true}return this._onPaste(D,E)},_onPaste:function(E,F){if(F.reverse){this.__changeSignal(E.type,F)}var D=this.__maskArray(F.valueArray,F.data.maskNonFixedCharsArray,F.data.maskArray,F.data.type,F.data.maxLength,F.data.defaultValue,F.data.fixedCharsReg,F.data.signal);F.$this.val(D);if(!F.reverse&&F.data.defaultValue.length&&(F.range.start===F.range.end)){this.__setRange(F._this,F.range.start,F.range.end)}if((C.browser.msie||C.browser.safari)&&!F.reverse){this.__setRange(F._this,F.range.start,F.range.end)}if(this.ignore){return true}this.__autoTab(F);return true},_onKeyPress:function(K,D){if(this.ignore){return true}if(D.reverse){this.__changeSignal(K.type,D)}var L=String.fromCharCode(D.nKey),N=D.range.start,H=D.value,F=D.data.maskArray;if(D.reverse){var G=H.substr(0,N),J=H.substr(D.range.end,H.length);H=G+L+J;if(D.data.signal&&(N-D.data.signal.length>0)){N-=D.data.signal.length}}var M=H.replace(D.data.fixedCharsRegG,"").split(""),E=this.__extraPositionsTill(N,F,D.data.fixedCharsReg);D.rsEp=N+E;if(D.repeat){D.rsEp=0}if(!this.rules[F[D.rsEp]]||(D.data.maxLength!=-1&&M.length>=D.data.maxLength&&D.repeat)){D.data.onOverflow.call(D._this,L,D.nKey);return false}else{if(!this.rules[F[D.rsEp]].test(L)){D.data.onInvalid.call(D._this,L,D.nKey);return false}else{D.data.onValid.call(D._this,L,D.nKey)}}var I=this.__maskArray(M,D.data.maskNonFixedCharsArray,F,D.data.type,D.data.maxLength,D.data.defaultValue,D.data.fixedCharsReg,D.data.signal,E);if(!D.repeat){D.$this.val(I)}return(D.reverse)?this._keyPressReverse(K,D):(D.fixed)?this._keyPressFixed(K,D):true},_keyPressFixed:function(D,E){if(E.range.start==E.range.end){if((E.rsEp===0&&E.value.length===0)||E.rsEp<E.value.length){this.__setRange(E._this,E.rsEp,E.rsEp+1)}}else{this.__setRange(E._this,E.range.start,E.range.end)}return true},_keyPressReverse:function(D,E){if(C.browser.msie&&((E.range.start===0&&E.range.end===0)||E.range.start!=E.range.end)){this.__setRange(E._this,E.value.length)}return false},__autoTab:function(E){if(E.data.autoTab&&((E.$this.val().length>=E.data.maskArray.length&&!E.repeat)||(E.data.maxLength!=-1&&E.valueArray.length>=E.data.maxLength&&E.repeat))){var D=this.__getNextInput(E._this,E.data.autoTab);if(D){E.$this.trigger("blur");D.focus().select()}}},__changeSignal:function(E,F){if(F.data.signal!==false){var D=(E==="paste")?F.value.charAt(0):String.fromCharCode(F.nKey);if(this.signals&&(typeof this.signals[D]!=="undefined")){F.data.signal=this.signals[D]}}},__getKeyNumber:function(D){return(D.charCode||D.keyCode||D.which)},__maskArray:function(L,G,F,I,D,J,M,K,E){if(I==="reverse"){L.reverse()}L=this.__removeInvalidChars(L,G,I==="repeat"||I==="infinite");if(J){L=this.__applyDefaultValue.call(L,J)}L=this.__applyMask(L,F,E,M);switch(I){case"reverse":L.reverse();return(K||"")+L.join("").substring(L.length-F.length);case"infinite":case"repeat":var H=L.join("");return(D!==-1&&L.length>=D)?H.substring(0,D):H;default:return L.join("").substring(0,F.length)}return""},__applyDefaultValue:function(F){var D=F.length,E=this.length,G;for(G=E-1;G>=0;G--){if(this[G]==F.charAt(0)){this.pop()}else{break}}for(G=0;G<D;G++){if(!this[G]){this[G]=F.charAt(G)}}return this},__removeInvalidChars:function(G,F,D){for(var E=0,H=0;E<G.length;E++){if(F[H]&&this.rules[F[H]]&&!this.rules[F[H]].test(G[E])){G.splice(E,1);if(!D){H--}E--}if(!D){H++}}return G},__applyMask:function(G,E,H,D){if(typeof H=="undefined"){H=0}for(var F=0;F<G.length+H;F++){if(E[F]&&D.test(E[F])){G.splice(F,0,E[F])}}return G},__extraPositionsTill:function(G,E,D){var F=0;while(D.test(E[G++])){F++}return F},__getNextInput:function(P,F){var E=P.form;if(E==null){return null}var I=E.elements,H=C.inArray(P,I)+1,K=I.length,N=null,J;for(J=H;J<K;J++){N=C(I[J]);if(this.__isNextInput(N,F)){return N}}var D=document.forms,G=C.inArray(P.form,D)+1,M,L,O=D.length;for(M=G;M<O;M++){L=D[M].elements;K=L.length;for(J=0;J<K;J++){N=C(L[J]);if(this.__isNextInput(N,F)){return N}}}return null},__isNextInput:function(F,D){var E=F.get(0);return E&&(E.offsetWidth>0||E.offsetHeight>0)&&E.nodeName!="FIELDSET"&&(D===true||(typeof D=="string"&&F.is(D)))},__setRange:function(F,G,D){if(typeof D=="undefined"){D=G}if(F.setSelectionRange){F.setSelectionRange(G,D)}else{var E=F.createTextRange();E.collapse();E.moveStart("character",G);E.moveEnd("character",D-G);E.select()}},__getRange:function(E){if(!C.browser.msie){return{start:E.selectionStart,end:E.selectionEnd}}var F={start:0,end:0},D=document.selection.createRange();F.start=0-D.duplicate().moveStart("character",-100000);F.end=F.start+D.text.length;return F},unmaskedVal:function(D){return C(D).val().replace(C.mask.fixedCharsRegG,"")}}});C.fn.extend({setMask:function(D){return C.mask.set(this,D)},unsetMask:function(){return C.mask.unset(this)},unmaskedVal:function(){return C.mask.unmaskedVal(this[0])}})})(jQuery)